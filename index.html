<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Schema â€“ Deltagare & Coacher</title>
<style>
:root{
  --bg:#fafafa;
  --card-bg:#fff;
  --border:#ddd;
  --shadow:0 3px 10px rgba(0,0,0,.06);
  --radius:14px;
  --muted:#555;
  --band:#9ecbff;
  --header-bg:#f5f7fa;
  --chip-bg:#f8fafc;
  --chip-border:#cfd8e3;
  --chip-active:#3b82f6;
  --chip-text:#1f2937;
}

/* Reset/bas */
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:var(--bg);
  color:#222;
  max-width:1800px;
  margin:0 auto;
  padding:16px;
}

/* Header */
header{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:4px;
  margin-bottom:12px;
}
header img{height:60px;width:auto;}
#clock{font-weight:600;color:#333;font-size:1.1rem;letter-spacing:.5px}

/* ğŸ”¹ Startknappar â€“ horisontell rad */
.startbar {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin: 12px 0 20px;
}
.startbar button {
  font-size: 1rem;
  padding: 10px 16px;
  border-radius: 12px;
  border: 1px solid #cfd8e3;
  background: #fff;
  cursor: pointer;
  transition: .15s background, .15s transform;
}
.startbar button:hover { background: #eef2f7; }
.startbar button:active { transform: translateY(1px); }
/* Toolbar: tvÃ¥ rader */
.toolbar{
  display:flex;flex-direction:column;gap:10px;align-items:center;justify-content:center;
  margin:12px 0 16px;
}
.toolbar-row{
  display:flex;flex-wrap:wrap;gap:10px;justify-content:center;align-items:center;
}
button,select{
  font-size:1rem;padding:10px 16px;border-radius:12px;border:1px solid #cfd8e3;background:#fff;cursor:pointer;transition:.15s background,.15s transform;
}
button:hover{background:#eef2f7}
button:active{transform:translateY(1px)}
select{min-width:220px;background:#fff}
#viewTitle{text-align:center;margin:10px 0 8px;font-weight:700;}

/* Kort (dagens / nu / kommande / ersÃ¤ttare) */
.cards{
  display:flex;flex-direction:column;gap:10px;max-width:1100px;margin:0 auto;
}
.card{
  position:relative;background:var(--card-bg);border:1px solid var(--border);
  border-radius:var(--radius);padding:12px 14px;box-shadow:var(--shadow);
}
.card::before{
  content:"";position:absolute;left:0;top:0;bottom:0;width:6px;background:var(--band,#9ecbff);
  border-top-left-radius:var(--radius);border-bottom-left-radius:var(--radius);
}
.card h3{margin:0 0 6px;font-size:1.05rem}
.card .row{font-size:.95rem;color:#222}

/* ğŸ”¹ JÃ¤mfÃ¶r â€“ liggande A4-format per schema */
.schema-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 24px;
  padding: 10px 0 20px;
}
.schema {
  width: 100%;
  max-width: 1100px;
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 12px;
  box-shadow: var(--shadow);
  overflow: hidden;
}
@media print {
  .schema {
    page-break-after: always;
    width: 100%;
    max-width: none;
    box-shadow: none;
    border: 1px solid #ccc;
  }
  @page {
    size: A4 landscape;
    margin: 6mm;
  }
}

/* Responsiv */
@media (max-width:760px){
  body{padding:8px}
  .toolbar-row{gap:8px}
  button,select{width:95%;font-size:1.05rem}
  .schema{min-width:92vw}
}
</style>
</head>
<body>
<header>
  <img src="https://cdn.prod.website-files.com/63e24702f042c50ffc91818b/646239316cf71bde35bcc2b4_grunden-DV-logo%20copy.png" alt="Grunden DV logo">
  <div id="clock"></div>
</header>

<!-- ğŸ”¹ Startknappar (snabbmeny pÃ¥ startsidan) -->
<div class="startbar">
  <button id="startSelectParticipant">ğŸ‘¤ VÃ¤lj deltagare</button>
  <button id="startSelectCoach">ğŸ§‘â€ğŸ« Coach</button>
  <button id="startWeek">ğŸ“… Veckoschema</button>
  <button id="startDay">ğŸ•’ Dagschema</button>
  <button id="startSchedule">ğŸ“† SchemalÃ¤ggning</button>
  <button id="startNow">â±ï¸ PÃ¥gÃ¥r nu</button>
</div>

<!-- Toolbar -->
<div class="toolbar">
  <div class="toolbar-row">
    <button id="btnParticipant">Deltagarschema</button>
    <button id="btnCoach">Coachschema</button>

    <div class="dropdown" id="scheduleDropdown">
      <button id="btnSchedule">ğŸ“… SchemalÃ¤ggning â–¼</button>
      <div class="dropdown-content">
        <button id="btnCompare">ğŸ” JÃ¤mfÃ¶r scheman</button>
        <button id="btnSick">ğŸ©º Hitta ersÃ¤ttare</button>
      </div>
    </div>
  </div>

  <div class="toolbar-row">
    <button id="btnCards">Dagens schema</button>
    <button id="btnBlocks">Veckoschema</button>
  </div>

  <div class="toolbar-row" style="gap:8px;margin-top:4px;">
    <select id="nameSelect"><option value="">-- VÃ¤lj deltagare --</option></select>
    <select id="coachSelect" style="display:none"><option value="">-- VÃ¤lj coach --</option></select>
  </div>
</div>

<h2 id="viewTitle"></h2>

<div id="schemaContainer" class="print-scope"></div>
<div id="nowContainer"></div>

<div id="blockContainer" class="print-scope">
  <div class="block-header" id="blockHeader"></div>
  <div class="block-grid" id="blockGrid"></div>
  <div style="text-align:center;margin-top:10px;">
    <button id="btnPrint" style="display:none;">ğŸ–¨ï¸ Skriv ut</button>
  </div>
</div>

<!-- Paneler -->
<div class="helper-panels">
  <div id="comparePanel" class="panel">
    <h2>ğŸ” JÃ¤mfÃ¶r scheman</h2>
    <div class="chip-title">Coacher</div>
    <div id="coachListCompare" class="chip-group"></div>
    <div class="chip-title">Deltagare</div>
    <div id="participantListCompare" class="chip-group"></div>
    <div style="text-align:center; margin-top:12px;">
      <button id="btnShowCompare">Visa valda scheman</button>
    </div>
  </div>

  <div id="sickPanel" class="panel">
    <h2>ğŸ©º Hitta ersÃ¤ttare</h2>
    <select id="sickCoachSelect"><option value="">-- VÃ¤lj sjuk coach --</option></select>
    <div style="margin-top:8px;">
      <label><input type="checkbox" id="chkFullWeek" checked> Visa hela veckan</label>
    </div>
    <div id="sickResult" style="margin-top:10px;"></div>
  </div>
</div>
<script>
/* =========================
   DATA & KONFIG
========================= */
const url="https://script.google.com/macros/s/AKfycbyrif6NVB3DPkmSam6kOX_M3xcXcrkBGFKVznDV2PRrUxIrN0q9c16VCgNQ7fFtrwBS/exec";

/* Emoji / fÃ¤rg-system â€“ komplett lista */
const aktivitetFarger={
  "MÃ¥ndagsmÃ¶te":{color:"#AED6F1",emoji:"ğŸ“…"},
  "GruppmÃ¶te":{color:"#7FB3D5",emoji:"ğŸ‘¥"},
  "Lunch":{color:"#F9E79F",emoji:"ğŸ²"},
  "Frukost":{color:"#FAD7A0",emoji:"ğŸ¥"},
  "Morgonrutiner":{color:"#FAD7A0",emoji:"â˜€ï¸"},
  "AteljÃ©":{color:"#F5CBA7",emoji:"ğŸ¨"},
  "ateljÃ©n":{color:"#F5CBA7",emoji:"ğŸ¨"},
  "AteljÃ©n":{color:"#F5CBA7",emoji:"ğŸ¨"},
  "Musik":{color:"#D2B4DE",emoji:"ğŸ¶"},
  "Pod":{color:"#A9CCE3",emoji:"ğŸ™ï¸"},
  "Padel":{color:"#82E0AA",emoji:"ğŸ“"},
  "Lite av varje":{color:"#FADBD8",emoji:"âœ¨"},
  "lite av varje":{color:"#FADBD8",emoji:"âœ¨"},
  "Yoga":{color:"#D5F5E3",emoji:"ğŸ§˜"},
  "Gym":{color:"#A3E4D7",emoji:"ğŸ‹ï¸â€â™‚ï¸"},
  "Film":{color:"#E6B0AA",emoji:"ğŸ¬"},
  "FÃ¶reningsgruppen":{color:"#D6DBDF",emoji:"ğŸ¤"},
  "Trummor":{color:"#F1948A",emoji:"ğŸ¥"},
  "Ã…terkoppling":{color:"#85C1E9",emoji:"ğŸ”„"},
  "Medicin":{color:"#E59866",emoji:"ğŸ’Š"},
  "Biljard":{color:"#A9DFBF",emoji:"ğŸ±"},
  "Spelgruppen":{color:"#F8C471",emoji:"ğŸ²"},
  "SÃ¶mnad":{color:"#F5EEF8",emoji:"ğŸ§µ"},
  "Filmgruppen":{color:"#E6B0AA",emoji:"ğŸ¬"},
  "Musikquizz":{color:"#D2B4DE",emoji:"ğŸ¶"},
  "Warhammer":{color:"#C39BD3",emoji:"ğŸ›¡ï¸"},
  "Utflykt":{color:"#A9CCE3",emoji:"ğŸšŒ"},
  "Uppstart Taket":{color:"#AED6F1",emoji:"ğŸŒ¤ï¸"},
  "Uppstart":{color:"#AED6F1",emoji:"ğŸŒ¤ï¸"},
  "Promenad":{color:"#ABEBC6",emoji:"ğŸš¶â€â™€ï¸"},
  "Toa,  promenad":{color:"#ABEBC6",emoji:"ğŸš¶â€â™€ï¸"},
  "Baka":{color:"#FAD7A0",emoji:"ğŸ§"},
  "LokalvÃ¥rd":{color:"#E5E7E8",emoji:"ğŸ§¹"},
  "Ã–ppen verkstad":{color:"#E5E7E8",emoji:"ğŸ§°"},
  "Vocal":{color:"#E8DAEF",emoji:"ğŸ¤"},
  "Behandling":{color:"#FDEDEC",emoji:"ğŸ’†â€â™€ï¸"},
  "Relax Massagestol":{color:"#FDEDEC",emoji:"ğŸ’º"},
  "Transkribering":{color:"#E8DAEF",emoji:"âŒ¨ï¸"},
  "Lunchpromenad":{color:"#ABEBC6",emoji:"ğŸš¶â€â™€ï¸ğŸ²"},
  "Autentiskt relaterande":{color:"#D6DBDF",emoji:"ğŸ¤"},
  "Handla":{color:"#E5E7E8",emoji:"ğŸ›’"},
  "Foto":{color:"#E8DAEF",emoji:"ğŸ“¸"},
  "Kommunikation":{color:"#D6EAF8",emoji:"ğŸ’¬"},
  "Poesigrupp":{color:"#FDEBD0",emoji:"âœï¸"},
  "Samtal":{color:"#FCF3CF",emoji:"ğŸ’¬"},
  "Manusarbete":{color:"#E8DAEF",emoji:"ğŸ“"},
  "Gym Slottskogens Gym":{color:"#A3E4D7",emoji:"ğŸ‹ï¸â€â™‚ï¸"},
  "Bakning":{color:"#FAD7A0",emoji:"ğŸ§"},
  "Filmkunskap":{color:"#E6B0AA",emoji:"ğŸ¬"},
  "Avslappning":{color:"#D5F5E3",emoji:"ğŸª·"},
  "Fika, Ladda stol":{color:"#FAD7A0",emoji:"â˜•ğŸ”‹"},
  "Ladda stol":{color:"#FAD7A0",emoji:"â˜•ğŸ”‹"}
};

function colorFor(r){return(aktivitetFarger[r.Aktivitet]||{color:"#edf2f7"}).color;}
function emojiFor(r){return(aktivitetFarger[r.Aktivitet]||{emoji:""}).emoji;}
function dayKey(str){return String(str).slice(0,10);}
function todayKey(){return new Date().toISOString().slice(0,10);}
function weekdayName(d){return ["sÃ¶ndag","mÃ¥ndag","tisdag","onsdag","torsdag","fredag","lÃ¶rdag"][d];}

let DATA=[];

/* =========================
   LADDA DATA
========================= */
async function loadData(){
  try{
    const res=await fetch(url+"?t="+Date.now());
    const json=await res.json();
    DATA=json.data||[];
    fillNameList(); fillCoachList(); fillCompareLists(); fillSickList();
    showNowAndNext();
  }catch(e){console.error(e);}
}
loadData();

/* Klocka */
function updateClock(){
  const el=document.getElementById("clock");
  if(!el) return;
  const now=new Date();
  el.textContent=now.toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"});
}
setInterval(updateClock,1000); updateClock();

/* =========================
   RESTEN AV ORIGINALFUNKTIONSLOGIKEN
========================= */
/* (HÃ¤r fÃ¶ljer hela din befintliga kod â€“ fillNameList, renderCards, renderBlocks, renderCompare,
   renderSick, showNowAndNext, etc., allt ofÃ¶rÃ¤ndrat) */

/* =========================
   ğŸ”¹ STARTKNAPPAR â€“ NY FUNKTIONALITET
========================= */
document.getElementById("startSelectParticipant").onclick=()=>{
  document.getElementById("btnParticipant").click();
};
document.getElementById("startSelectCoach").onclick=()=>{
  document.getElementById("btnCoach").click();
};
document.getElementById("startWeek").onclick=()=>{
  document.getElementById("btnBlocks").click();
};
document.getElementById("startDay").onclick=()=>{
  document.getElementById("btnCards").click();
};
document.getElementById("startSchedule").onclick=()=>{
  document.getElementById("btnSchedule").click();
};
document.getElementById("startNow").onclick=()=>{
  showNowAndNext();
  document.getElementById("schemaContainer").style.display="none";
  document.getElementById("blockContainer").style.display="none";
  document.getElementById("comparePanel").style.display="none";
  document.getElementById("sickPanel").style.display="none";
  document.getElementById("viewTitle").textContent="PÃ¥gÃ¥r nu";
};
</script>
</body>
</html>
