<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dagens schema</title>
  <style>
    body { 
      font-family: sans-serif; 
      max-width: 1200px;
      margin: 0 auto; 
      padding: 20px; 
      position: relative;
    }
    h1 { margin-bottom: 10px; }
    #clock { font-family: monospace; font-size: 18px; margin-bottom: 15px; }
    header img { 
      height: 60px; 
      position: absolute; 
      top: 20px; 
      right: 20px; 
    }

    /* Tabell fÃ¶r desktop */
    .table-container { overflow-x: auto; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
    th { background: #f2f2f2; }
    td.aktivitet { font-weight: bold; }

    /* Lista fÃ¶r mobil */
    .list-container { display: none; }
    .list-item {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
    }
    .list-item strong { display: block; margin-bottom: 4px; }

    /* Byt vy pÃ¥ smÃ¥ skÃ¤rmar */
    @media (max-width: 600px) {
      .table-container { display: none; }
      .list-container { display: block; }
      h1 { font-size: 20px; }
      #clock { font-size: 14px; }
      header img { height: 40px; }
    }
  </style>
</head>
<body>
  <header>
    <img src="https://cdn.prod.website-files.com/63e24702f042c50ffc91818b/646239316cf71bde35bcc2b4_grunden-DV-logo%20copy.png" alt="Logga">
  </header>

  <h1>Dagens schema</h1>
  <div id="clock"></div>

  <!-- Desktop tabell -->
  <div class="table-container">
    <table id="schema">
      <thead>
        <tr>
          <th>Start</th>
          <th>Slut</th>
          <th>Aktivitet</th>
          <th>Deltagare</th>
          <th>Coach</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Mobil lista -->
  <div class="list-container" id="schema-list"></div>

<script>
// --- fÃ¤rger & emojis ---
const aktivitetFarger = {
  "MÃ¥ndagsmÃ¶te":     {color:"#AED6F1", emoji:"ğŸ“…"},
  "GruppmÃ¶te":       {color:"#7FB3D5", emoji:"ğŸ‘¥"},
  "Lunch":           {color:"#F9E79F", emoji:"ğŸ²"},
  "Frukost":         {color:"#FAD7A0", emoji:"ğŸ¥"},
  "AteljÃ©":          {color:"#F5CBA7", emoji:"ğŸ¨"},
  "Musik":           {color:"#D2B4DE", emoji:"ğŸ¶"},
  "Pod":             {color:"#A9CCE3", emoji:"ğŸ™ï¸"},
  "Padel":           {color:"#82E0AA", emoji:"ğŸ“"},
  "Lite av varje":   {color:"#FADBD8", emoji:"âœ¨"},
  "Yoga":            {color:"#D5F5E3", emoji:"ğŸ§˜"},
  "Gym":             {color:"#A3E4D7", emoji:"ğŸ‹ï¸â€â™‚ï¸"},
  "Lunchpromenad":   {color:"#F7DC6F", emoji:"ğŸš¶â€â™‚ï¸ğŸ²"},
  "Kulturpromenad":  {color:"#F8C471", emoji:"ğŸ›ï¸ğŸš¶"},
  "Film":            {color:"#E6B0AA", emoji:"ğŸ¬"},
  "Behandling":      {color:"#EDBB99", emoji:"ğŸ’†"},
  "Handla":          {color:"#ABEBC6", emoji:"ğŸ›ï¸"},
  "GÃ¥trÃ¤ning":       {color:"#76D7C4", emoji:"ğŸš¶"},
  "Uppstart":        {color:"#F0B27A", emoji:"ğŸš€"},
  "Poesigruppen":    {color:"#F1948A", emoji:"âœï¸"},
  "Trummor":         {color:"#F1948A", emoji:"ğŸ¥"},
  "Rollspel":        {color:"#BB8FCE", emoji:"ğŸ‰"},
  "Ã…terkoppling":    {color:"#85C1E9", emoji:"ğŸ”„"},
  "Handling":        {color:"#73C6B6", emoji:"ğŸ›’"},
  "Medicin":         {color:"#E59866", emoji:"ğŸ’Š"},
  "FÃ¶reningsgruppen":{color:"#D6DBDF", emoji:"ğŸ¤"},
  "Ã–ppen verkstad":  {color:"#F5B7B1", emoji:"ğŸ”§"},
  "Biljard":         {color:"#A9DFBF", emoji:"ğŸ±"},
  "Spelgruppen":     {color:"#F8C471", emoji:"ğŸ²"},
  "SÃ¶mnad":          {color:"#F5EEF8", emoji:"ğŸ§µ"},
  "Filmkunskap":     {color:"#E6B0AA", emoji:"ğŸ¬"},
  "Musikquizz":      {color:"#D2B4DE", emoji:"ğŸ¶"},
  "MusikdokumentÃ¤r": {color:"#D2B4DE", emoji:"ğŸ¶"}
};

// --- hÃ¤mta schema ---
async function loadSchema() {
  const url = "https://script.google.com/macros/s/AKfycbzujIM80MWW1nsKDPySb4M0m2ylvUWk_SBko5Q_SJGfWJmcROFAxWf0jNjFi-nBVcA/exec"; 
  try {
    const res = await fetch(url);
    const json = await res.json();
    const tbody = document.querySelector("#schema tbody");
    const listContainer = document.getElementById("schema-list");
    tbody.innerHTML = "";
    listContainer.innerHTML = "";

    const now = new Date();
    const nowStr = now.toTimeString().slice(0,5);
    const hour = now.getHours();

    // visa inget fÃ¶re 06:00 eller efter 16:00
    if (hour < 6 || hour >= 16) return;

    json.data.forEach(row => {
      const [start, slut, aktivitet, deltagare, coach] = row;

      // filtrera bara 08â€“16
      const startHour = parseInt(start.split(":")[0], 10);
      const endHour = parseInt(slut.split(":")[0], 10);
      if (startHour < 8 || endHour > 16) return;

      // status
      let status = "";
      if (slut <= nowStr) {
        status = "âŒ"; // redan slut
      } else if (start <= nowStr && slut >= nowStr) {
        status = "ğŸŸ¢"; // pÃ¥gÃ¥ende
      }

      const fargEmoji = aktivitetFarger[aktivitet] || {color:"#fff", emoji:""};
      const aktivitetText = `${status} ${fargEmoji.emoji ? fargEmoji.emoji+" " : ""}${aktivitet}`;

      // tabell (desktop) â€“ hel rad fÃ¤rg
      const tr = document.createElement("tr");
      tr.style.background = fargEmoji.color;
      tr.innerHTML = `
        <td>${start}</td>
        <td>${slut}</td>
        <td class="aktivitet">${aktivitetText}</td>
        <td>${deltagare}</td>
        <td>${coach}</td>
      `;
      tbody.appendChild(tr);

      // lista (mobil)
      const div = document.createElement("div");
      div.className = "list-item";
      div.style.background = fargEmoji.color;
      div.innerHTML = `
        <strong>${start}â€“${slut} ${aktivitetText}</strong>
        <div>ğŸ‘¥ ${deltagare}</div>
        <div>ğŸ“ ${coach}</div>
      `;
      listContainer.appendChild(div);
    });
  } catch (err) {
    console.error("Fel vid hÃ¤mtning:", err);
  }
}

// --- klocka ---
function updateClock() {
  const now = new Date();
  document.getElementById("clock").textContent =
    now.toLocaleDateString("sv-SE", { weekday: "long", year: "numeric", month: "long", day: "numeric" }) +
    " " +
    now.toLocaleTimeString("sv-SE", { hour: "2-digit", minute: "2-digit", second: "2-digit" });
}

setInterval(updateClock, 1000);
updateClock();
loadSchema();
setInterval(() => {
  if (new Date().getHours() >= 6) loadSchema();
}, 30*60*1000);
</script>
</body>
</html>
