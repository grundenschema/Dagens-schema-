<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grundenschema</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://cdn.prod.website-files.com/63e24702f042c50ffc91818b/648af43c60a6ff58e7083e01_Grunden_logotyp-vit-transparent.png">

  <!-- CSS -->
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f4f4f4; }
    #clockDiv, #dateDiv { font-size: 18px; margin-top: 10px; }
  </style>
</head>
<body>

  <h1>Grundenschema</h1>
  <div id="dateDiv"></div>
  <div id="clockDiv"></div>

  <!-- H√§r kommer schemat -->
  <div id="schedule"></div>

  <script>
    const clockDiv = document.getElementById('clockDiv');
    const dateDiv = document.getElementById('dateDiv');
    const scheduleDiv = document.getElementById('schedule');

    // Veckonummer
    function getWeekNumber(d) {
      const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
      const dayNum = date.getUTCDay() || 7;
      date.setUTCDate(date.getUTCDate() + 4 - dayNum);
      const yearStart = new Date(Date.UTC(date.getFullYear(), 0, 1));
      return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);
    }

    // Datum
    function updateDate() {
      const now = new Date();
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      dateDiv.textContent = now.toLocaleDateString('sv-SE', options) + ' | Vecka ' + getWeekNumber(now);
    }

    // Klocka
    function updateClock() {
      const now = new Date();
      clockDiv.textContent = now.toLocaleTimeString('sv-SE', {
        hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
    }

    updateDate();
    updateClock();
    setInterval(updateClock, 1000);

    // üîÑ Uppdatera hela sidan varje minut
    setInterval(() => window.location.reload(), 60000);

    // H√§mta schemat fr√•n Google Sheets (publicera som CSV)
    const csvUrl = 'DIN_CSV_L√ÑNK_H√ÑR'; // byt mot din publicerade CSV-l√§nk

    fetch(csvUrl)
      .then(response => response.text())
      .then(data => {
        const rows = data.split('\n').map(row => row.split(','));
        let html = '<table>';
        rows.forEach((row, index) => {
          html += '<tr>';
          row.forEach(cell => {
            if(index === 0){
              html += `<th>${cell}</th>`;
            } else {
              html += `<td>${cell}</td>`;
            }
          });
          html += '</tr>';
        });
        html += '</table>';
        scheduleDiv.innerHTML = html;
      })
      .catch(error => {
        scheduleDiv.innerHTML = '<p>Det gick inte att h√§mta schemat.</p>';
        console.error('Fel vid h√§mtning av schemat:', error);
      });
  </script>

</body>
</html>
