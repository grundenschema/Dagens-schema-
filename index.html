const dateDiv = document.getElementById('date');
const weekDiv = document.getElementById('week');
const clockDiv = document.getElementById('clock');
const iframe = document.getElementById('spreadsheet-iframe');

const weekdays = ['Söndag','Måndag','Tisdag','Onsdag','Torsdag','Fredag','Lördag'];
const months = ['januari','februari','mars','april','maj','juni','juli','augusti','september','oktober','november','december'];

function getWeekNumber(d) {
  d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
  const dayNum = d.getUTCDay() || 7;
  d.setUTCDate(d.getUTCDate() + 4 - dayNum);
  const yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
  return Math.ceil((((d - yearStart) / 86400000) + 1)/7);
}

function updateDate() {
  const now = new Date();
  dateDiv.textContent = `${weekdays[now.getDay()]} ${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()}`;
  weekDiv.textContent = `Vecka ${getWeekNumber(now)}`;
}

function updateClock() {
  const now = new Date();
  clockDiv.textContent = now.toLocaleTimeString('sv-SE', {
    hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'
  });
}

function scheduleMidnightUpdate() {
  const now = new Date();
  const midnight = new Date(now);
  midnight.setHours(24,0,0,0);
  const msToMidnight = midnight - now;

  setTimeout(() => {
    updateDate();
    setInterval(updateDate, 24*60*60*1000);
  }, msToMidnight);
}

// Init
updateDate();
updateClock();
scheduleMidnightUpdate();

// Uppdatera klockan varje sekund
setInterval(updateClock, 1000);

// Uppdatera iframe var 30:e sekund
setInterval(() => {
  iframe.contentWindow.location.reload();
}, 30000);




